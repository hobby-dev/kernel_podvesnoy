# Макросы
Препроцессор - одна из стадий сборки программы, выполняется перед компиляцией программы.
Макрос - элемент препроцессора языка Си, раскрывается на этапе препроцессора.
См. macro.c
Чтобы остановить компиляцию после препроцессовра gcc -E - мы увидим макросы
Нужно больше скобок внутри макросов!
Опасайся двойной подстановки (см. пример с max(++x, y)
do { ... тело макроса ... } while 0 чтобы безопасно ставить ';' после макроса
но в нём нельзя использовать break

## Макроподстановки: # и ##
То что передаётся в макрос можно использовать как текст (см. пример print_type)
Преобразуется #param преобразуется в строковый литерал
А ## позволяет склеить два параметра в коде
Ещё есть ```#_Generic``` но это жесть, мы его не рассматривали

# Структуры ядра: списки
Каждый элемент ссылается на другой элемент, например, с помощью указателя.
```
struct some_data {
    int value;
    struct some_data * next;
    struct some_data * prev;
}
```
Бываю двусвязные списки - с указателем на предыдущий элемент.
Обычно конец списка обозначают указателем на NULL.
Но бывают циклические списки. Можно перебирать в любом направлении двунаправленный циклический список.
Именно такие и используются в ядре Linux - циклические двунаправленные.
Однако, там есть особенность:
```
struct list_head {
    struct list_head * next;
    struct list_head * prev;
}
```
Чтобы превратить структуру в список, мы должны добавить struct list_head к нашей структуре:
```
struct data_struct
{
    int some_value;
    struct list_head data_list_elem;
}
```


